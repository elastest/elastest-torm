version: '3'
services:        
    etm-logstash:        
        image: elastest/etm-logstash
        ports:
            - 5002:5002
            - 5000:5000
            - 5037:5037
            - 5003:5003
            - 5044:5044
        depends_on:
            - etm-rabbitmq
            - edm-elasticsearch
        environment:
            - ELASTICHOST=edm-elasticsearch
            - RABBITHOST=etm-rabbitmq
            - RABBITUSER=elastest-etm
            - RABBITPASS=elastest-etm
        networks:
            - elastest       
                                  
    etm-rabbitmq:
        image: elastest/etm-rabbitmq
        hostname: my-rabbit
        ports:
            - 15672:15672
            - 5672:5672
            - 15671:15671
            - 25672:25672
            - 61613:61613
        networks:
            - elastest

    etm-testlink:
      image: 'elastest/etm-testlink'
      depends_on:
            - edm-mysql
      ports:
            - 37071:80
            - 37443:443
      environment:
            TESTLINK_USERNAME: admin
            TESTLINK_PASSWORD: elastest
            MARIADB_HOST: edm-mysql
            MARIADB_PASSWORD:
            MARIADB_PORT_NUMBER: 3306
            MARIADB_USER: root
      networks:
             - elastest
      volumes:
             - etm-testlink:/bitnami
volumes:
    beats-data:
      driver: local
networks:
    elastest:
      driver: bridge
