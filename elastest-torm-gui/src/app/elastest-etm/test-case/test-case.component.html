<auto-height-grid fxLayout="row" fxLayout.lt-md="column" *ngIf="testCase" id="testCaseContent" fxFlexFill>
  <auto-height-row class="mat-content">
    <self-adjustable-card id="testCaseTabsCard" [hideTitle]="true">
      <sa-card-content fxFlexFill fxLayout="column">
        <mat-tab-group #testCaseTabGroup id="testCaseTabGroup" [(selectedIndex)]="selectedTab">
          <mat-tab label="Log Analyzer">
            <elastest-log-analyzer
              #miniLogAnalyzer
              *ngIf="testCase"
              [isEmbed]="true"
              [tJobId]="tJobId"
              [tJobExecId]="tJobExecId"
              [testCase]="testCase.name"
            ></elastest-log-analyzer>
          </mat-tab>

          <mat-tab label="Details">
            <etm-test-case-detail fxLayout="column" fxFlexFill [testCase]="testCase"></etm-test-case-detail>
          </mat-tab>

          <mat-tab label="Files">
            <ng-template matTabContent>
              <div fxLayout="row" fxFlexFill *ngIf="testCase && testCase.files && testCase.files.length > 0; else showEmptyMsg">
                <td-data-table
                  #filesTable
                  fxFlex
                  id="filesTable"
                  class="useMaxHeight"
                  [data]="testCase.files"
                  [columns]="filesColumns"
                  [resizableColumns]="true"
                >
                  <ng-template
                    *ngFor="let column of filesColumns"
                    tdDataTableTemplate="{{ column.name }}"
                    let-value="value"
                    let-row="row"
                  >
                    <ng-container *ngIf="column.name !== 'options'">
                      {{ value }}
                    </ng-container>
                  </ng-template>

                  <!-- OPTIONS -->
                  <ng-template tdDataTableTemplate="options" let-value="value" let-row="row" let-column="column">
                    <div fxLayout="row" class="sutOptions optionsColumn">
                      <ng-container *ngIf="isMP4(row)">
                        <i
                          class="material-icons"
                          (click)="openUrlInNewTab(row)"
                          id="view_recording_new_tab"
                          matTooltip="Open in new tab"
                          >open_in_new</i
                        >
                        <i class="material-icons" (click)="goToVideoTab(row)" id="view_recording" matTooltip="Open"
                          >open_in_browser</i
                        >
                      </ng-container>
                    </div>
                  </ng-template>
                </td-data-table>
              </div>
              <ng-template #showEmptyMsg>
                <centered-element class="push-top-important messageEmptyCard">
                  <mat-icon>assignment</mat-icon>
                  <p>No Files found</p>
                </centered-element>
              </ng-template>
            </ng-template>
          </mat-tab>

          <mat-tab *ngFor="let file of mp4Files">
            <ng-template mat-tab-label>
              <mat-icon matTooltip="Video {{ file.name }}" id="videoIcon">play_circle_filled</mat-icon>
            </ng-template>
            <ng-template matTabContent>
              <div id="videoContent">
                <video controls id="video" [src]="this.getVideoFileUrl(file)" type="video/mp4"></video>
              </div>
            </ng-template>
          </mat-tab>

          <mat-tab *ngIf="showLogsAndMetrics" disabled>
            <ng-template mat-tab-label>
              <button
                id="openMonitoringConfigBtn"
                mat-mini-fab
                color="accent"
                *ngIf="showLogsAndMetrics"
                (click)="logsAndMetrics.openMonitoringConfig()"
                class="onlyIconBtn matTabOnlyBtn"
                matTooltip="Open Monitoring Config"
              >
                <mat-icon>settings</mat-icon>
              </button>
            </ng-template>
          </mat-tab>

          <mat-tab *ngIf="tJobExec" disabled>
            <ng-template mat-tab-label>
              <button
                mat-mini-fab
                color="accent"
                (click)="viewInLogAnalyzer()"
                class="onlyIconBtn matTabOnlyBtn"
                matTooltip="View Case in Log Analyzer"
              >
                <mat-icon>library_books</mat-icon>
              </button>
            </ng-template></mat-tab
          >
        </mat-tab-group>
      </sa-card-content>
    </self-adjustable-card>
  </auto-height-row>
</auto-height-grid>
<auto-height-row>
  <etm-monitoring-view #logsAndMetrics [live]="false" [showConfigBtn]="false" [hideLogs]="true"></etm-monitoring-view>
</auto-height-row>
